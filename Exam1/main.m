clear all;
close all;
clc;

z = [367.426067023724
23779.4593915456
12846.8299987297
-18662.4933331644
7984.52275474047
907.737690145488];

H = [122.747974553825 -700.205624002536 -288.72922150566
-6161.41287306561 -17321.8364059845 -11741.6232165692
-8745.71054008378 1414.28877217844 -3665.71330902301
8529.78921867569 6245.78023146386 7387.79003058372
-7900.66437226995 5784.61586018735 -1058.01203361061
2945.79594212046 -6989.02671091266 -2021.60425818948];

R = [
2.36519215943924 0.057845076600491 1.01307108063044 -0.558431761588577 1.81387196612649 -0.394688155222653
0.057845076600491 1.85476678558121 -0.611482029811377 1.69343840421604 2.62478404586119 2.34080310702718
1.01307108063044 -0.611482029811377 8.56587413452779 1.37856896419802 2.75188091884609 -2.38121782107832
-0.558431761588577 1.69343840421604 1.37856896419802 5.17266218453676 3.29441874285897 1.78429853967157
1.81387196612649 2.62478404586119 2.75188091884609 3.29441874285897 9.17143948110111 0.447330044307135
-0.394688155222653 2.34080310702718 -2.38121782107832 1.78429853967157 0.447330044307135 4.62657818768543];


[xhat_sribls, R0tilde_sribls] = sribls(H, z, R)

xhat_ls = inv(H'*inv(R)*H)*H'*inv(R)*z

dxhat = xhat_sribls' - xhat_ls

error_mag = norm(dxhat)

% We should certainly trust the estimate from the square root method more,
% since it aviods squaring the high condition number of H ( 1.7882e+06 ) in
% this case. The condition number of Ht*H such as we perform in normal LS
% estimation is on the order of ( 3.1977e+12 ). This affects the precision
% of the estimate, in this example to the tune of the estimates differing
% by a magnitude of 30 units